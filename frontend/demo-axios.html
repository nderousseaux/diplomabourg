<!--axios.defaults.headers.common['Authorization'] = token reçu-->




<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>

        <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    </head>
    <body>
        <div id="app">
            <button @click='getPowersList()'>Mettre à jour</button>
            <ul>
                <li></li>
            </ul>
        </div>

        <script>
        axios.defaults.headers.post['Access-Control-Allow-Origin'] = '*';


            var app = new Vue({
                el: '#app',
                methods:{
                    getPowersList() {
                      axios.get('http://localhost:10005/maps')
                            .then(response => console.log(response.data[0].powers))
                            .catch(function(err) {
                              console.log(err)
                            });
                    },
                  //readyToPlay peut servir pour le lancement de partie tout comme pour la validation des ordres
                    readyToPlay() {
                        axios.put('http://localhost:10005/games/10/players/1', {ready:true})
                              .then(response => console.log(response))
                              .catch(function(err){
                                console.log(err)
                              });
                    },
                    getUsers() {
                        console.log("PLAYERS : ");
                        axios.get('http://localhost:10005/games/1/players')
                              .then(response => console.log(response.data))
                              .catch(function(err){
                                console.log(err)
                              });
                    },
                    getmaps(){
                        console.log("MAPS : ");
                        axios.get('http://localhost:10005/maps')
                        .then(response => console.log(response.data))
                        .catch(function (err){
                            console.log(err)
                        });
                    },
                    getmap() {
                        console.log("MAP : ");
                        var id = 1;
                        const url = `http://localhost:10005/maps/${id}`;
                        axios.get(url)
                        .then(response => console.log(response.data))
                        .catch(function (err) {
                            console.log(err)
                        });
                    },
                    postcreategame() {
                        //game_id à mettre en data(){return{game_id:''}}
                        var game_id;

                        var username = "username";
                        var game_name = "game_de_test9";
                        var game_password = "mdpnul";
                        var map_id = 1;

                        const game = { name: `${game_name}`,
                        password: `${game_password}`,
                        map_id: `${map_id}`
                        } ;

                        const jeu = { player : {
                          username: `${username}`
                        },
                        game: game
                        };
                        console.log(jeu);
                        axios.post('http://localhost:10005/games', jeu)
                            .then(response => {
                              game_id = response.data.game.id
                              console.log(game_id);
                              axios.defaults.headers.common['Authorization'] = response.data.token
                              console.log(response)
                            })
                            .catch(function (err) {
                                console.log(err.response.data.error.message[0].game.name[0])
                            });
                    },
                    rejoindregame() {
                        var id = 10;
                        var username = "username2";
                        var password = "mdpnul";

                        var joueur = {
                            "username": `${username}`,
                        };


                        axios.post(`http://localhost:10005/games/${id}/players?password=${password}`, joueur)
                            .then(response => {
                              console.log(response.data)
                              axios.defaults.headers.common['Authorization'] = response.data.token
                            })
                            .catch(function (err) {
                              console.log(err);
                            });
                    },
                    post_ordre() {
                        var id = 10;
                        var username = "username2";

                        var ordre = {
                            "type": `${username}`,
                            "region_id": `${1}`,
                            "unit_id": `${1}`
                        };

                        axios.post(`http://localhost:10005/games/${id}/orders/`, ordre)
                            .then(response => console.log(response.data))
                            .catch(function (err) {
                                console.log(err);
                        });
                    }
                }
            });
        </script>

    </body>
</html>



<!--
page acceuil
    OK get les maps existantes
    KO bouton créer la partie : post “/games” –> la réponse contient l’id de la partie

{
"username": "{{player_name}}",
"game": {
"name": "{{game_name}}",
"password": "{{game_password}}",
"map_id": "{{map_id}}"
}
}

pop up pour rejoindre la partie :
    KO bouton valider :
     /games/:game_id/players
    {
    "username": "{{player_name}}"
    }

page jeu
    OK get la map
    bouton valider ordre
    /games/:game_id/orders/
    {
    "type": "{{player_name}}",
    "region_id": "{{region_id}}",
    "unit_id": "{{unit_id}}"
    }


-->
